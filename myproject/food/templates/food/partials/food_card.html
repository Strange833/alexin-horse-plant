<div class="food-card">
    <!-- –ë–µ–π–¥–∂–∏ -->
    <div class="food-badges">
        {% if food.is_new %}
        <span class="food-badge badge-new">–ù–û–í–ò–ù–ö–ê</span>
        {% endif %}
        
        {% if food.is_best_seller %}
        <span class="food-badge badge-bestseller">–•–ò–¢</span>
        {% endif %}
        
        {% if food.is_featured %}
        <span class="food-badge badge-featured">–í–´–ë–û–†</span>
        {% endif %}
        
        {% if food.get_discount_percentage > 0 %}
        <span class="food-badge badge-discount">-{{ food.get_discount_percentage }}%</span>
        {% endif %}
    </div>
    
    <!-- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
    <div class="food-image">
        {% if food.image %}
        <img src="{{ food.image.url }}" alt="{{ food.name }}" loading="lazy">
        {% else %}
        <div class="image-placeholder">ü•ï</div>
        {% endif %}
    </div>
    
    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="food-info">
        <div class="food-category">
            <span>{{ food.category.icon|default:"ü•ï" }}</span>
            {{ food.category.name|default:"–ö–æ—Ä–º–∞" }}
        </div>
        
        <h3 class="food-name">{{ food.name }}</h3>
        
        <p class="food-description">
            {{ food.short_description|default:food.description|truncatechars:100 }}
        </p>
        
        <div class="food-price-section">
            <span class="food-price">
                {% if user.is_authenticated and user_profile and user_profile.is_premium %}
                    {{ food.get_price_for_user|floatformat:0 }} ‚ÇΩ
                {% else %}
                    {{ food.base_price|floatformat:0 }} ‚ÇΩ
                {% endif %}
            </span>
            
            {% if food.get_discount_percentage > 0 %}
            <span class="original-price">{{ food.base_price|floatformat:0 }} ‚ÇΩ</span>
            {% endif %}
            
            <span class="food-unit">{{ food.weight }} {{ food.get_unit_display }}</span>
        </div>
        
        <!-- –†–µ–π—Ç–∏–Ω–≥ -->
        {% if food.rating > 0 %}
        <div class="food-rating">
            <span class="rating-stars">
                {% for i in "12345" %}
                    {% if forloop.counter <= food.rating|add:"0.5"|floatformat:0|add:"0" %}
                        ‚òÖ
                    {% else %}
                        ‚òÜ
                    {% endif %}
                {% endfor %}
            </span>
            <span class="rating-count">({{ food.review_count }})</span>
        </div>
        {% endif %}
        
        <!-- –ù–∞–ª–∏—á–∏–µ -->
        <div class="food-stock {% if food.is_in_stock %}{% if food.is_low_stock %}stock-low{% else %}stock-in{% endif %}{% else %}stock-out{% endif %}">
            {% if food.is_in_stock %}
                {% if food.is_low_stock %}
                    ‚ö†Ô∏è –û—Å—Ç–∞–ª–æ—Å—å –º–∞–ª–æ
                {% else %}
                    ‚úÖ –í –Ω–∞–ª–∏—á–∏–∏
                {% endif %}
            {% else %}
                ‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏
            {% endif %}
        </div>
        
        <!-- –î–µ–π—Å—Ç–≤–∏—è -->
        <div class="food-actions">
            <a href="{% url 'food_detail' food.id %}" class="btn-view">
                –ü–æ–¥—Ä–æ–±–Ω–µ–µ
            </a>
            
            {% if food.is_in_stock %}
            <button class="btn-add-cart" 
                    onclick="addToCartFromCard('{{ food.id }}')"
                    title="–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É"
                    {% if not user.is_authenticated %}disabled{% endif %}>
                üõí
            </button>
            {% endif %}
        </div>
    </div>
</div>

{% if not user.is_authenticated %}
<script>
    function addToCartFromCard(foodId) {
        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        alert('–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.');
        // –ò–ª–∏ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
        // window.location.href = '{% url "login" %}';
    }
</script>
{% endif %}